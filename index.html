<html>
<body>
<pre>
<code>
## SLIP 1

CREATE TABLE Dept (
    dno INT PRIMARY KEY,
    dname VARCHAR(50) NOT NULL,
    loc VARCHAR(50)
);

CREATE TABLE Emp (
    eno INT PRIMARY KEY,
    ename VARCHAR(50) NOT NULL,
    designation VARCHAR(50),
    salary DECIMAL(10,2) CHECK (salary > 0),
    Date_Of_Joining DATE,
    dno INT,
    FOREIGN KEY (dno) REFERENCES Dept(dno)
);

-- Inserting data into Dept table
INSERT INTO Dept (dno, dname, loc) VALUES
(1, 'Account Department', 'Pune'),
(2, 'Quality', 'Mumbai'),
(3, 'Computer Science', 'Bangalore');

-- Inserting data into Emp table
INSERT INTO Emp (eno, ename, designation, salary, Date_Of_Joining, dno) VALUES
(101, 'Mr. Manager', 'Manager', 80000.00, '2020-01-01', 1),
(102, 'Mr. Advait', 'Staff', 60000.00, '2018-05-15', 1),
(103, 'Mr. Roy', 'Staff', 55000.00, '2017-07-20', 3),
(104, 'Mr. Ankit', 'Manager', 70000.00, '2019-02-10', 2),
(105, 'Ms. Priya', 'Staff', 65000.00, '2018-10-05', 2),
(106, 'Mr. John', 'Staff', 50000.00, '2020-03-12', 3),
(107, 'Ms. Maya', 'Staff', 45000.00, '2021-04-25', 2);


SELECT d.dname AS Department, COUNT(e.eno) AS Employee_Count
FROM Dept d
LEFT JOIN Emp e ON d.dno = e.dno
GROUP BY d.dname;

SELECT e.ename
FROM Emp e
JOIN Dept d ON e.dno = d.dno
WHERE e.designation = 'Manager' AND d.dname = 'Account Department';

SELECT d.dname AS Department
FROM Dept d
JOIN Emp e ON d.dno = e.dno
WHERE d.loc = 'Pune' AND e.ename = 'Mr. Advait';

SELECT e.ename
FROM Emp e
JOIN Dept d ON e.dno = d.dno
WHERE e.salary > 50000 AND d.dname = 'Quality';

UPDATE Emp
SET Date_Of_Joining = '2019-06-15'
WHERE ename = 'Mr. Roy' AND dno IN (SELECT dno FROM Dept WHERE dname = 'Computer Science');

--------------------------------------
##SLIP 4

CREATE TABLE Patient (
    PCode INT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    Addr VARCHAR(255) NOT NULL,
    Disease VARCHAR(100)
);

CREATE TABLE Bed (
    Bed_No INT PRIMARY KEY,
    RoomNo INT CHECK(RoomNo > Bed_No),
    loc VARCHAR(100),
    FOREIGN KEY (Bed_No) REFERENCES Patient(PCode)
);

-- Insert data for Patient table
INSERT INTO Patient (PCode, Name, Addr, Disease) VALUES
(1, 'John Doe', 'Pimple Gurav', 'Fever'),
(2, 'Jane Smith', 'Hinjewadi', 'Cough'),
(3, 'Alice Johnson', 'Pimple Gurav', 'Headache'),
(4, 'Bob Williams', 'Kothrud', 'Flu'),
(5, 'sam Luthor', 'Pimple Gurav', 'malaria'),
(6, 'Robert', 'kharadi', 'flu');
--Insert data for Bed table
INSERT INTO Bed (Bed_No, RoomNo, loc) VALUES
(1, 105, 'South Wing'),
(2, 102, 'East Wing'),
(3, 102, 'North Wing'),
(4, 103, 'West Wing'),
(5, 105, 'South Wing'),
(6, 101, 'north wing');

SELECT * FROM Patient WHERE Addr = 'Pimple Gurav'

DELETE FROM Bed
WHERE Bed_No = 1 AND RoomNo = 105;
DELETE FROM Patient WHERE PCode = 1;  -- Assuming Bed_No is the same as PCode

SELECT RoomNo, COUNT(*) AS Patient_Count 
FROM Bed GROUP BY RoomNo;

SELECT P.Name AS Patient_Name
FROM Patient P 
JOIN Bed B ON P.PCode = B.Bed_No 
WHERE B.RoomNo = 101;

SELECT Disease  FROM Patient WHERE PCode = 1; -- Assuming Bed_No is the same as PCode  

-------------------------------------
## SLIP 5
    
CREATE TABLE Customer (
    cust_no INT PRIMARY KEY,
    cust_name VARCHAR(100),
    address VARCHAR(255),
    city VARCHAR(100)
);
ALTER TABLE Customer
ADD Phone_No INT;

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    loan_amt DECIMAL(12, 2) CHECK (loan_amt > 0)
);

CREATE TABLE Customer_Loan (
    cust_no INT,
    loan_no INT,
    PRIMARY KEY (cust_no, loan_no),
    FOREIGN KEY (cust_no) REFERENCES Customer(cust_no) ON DELETE CASCADE,
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no) ON DELETE CASCADE
);

INSERT INTO Customer (cust_no, cust_name, address, city, Phone_No)
VALUES
    (1, 'John Doe', '123 Main St', 'New York', 1234567890),
    (2, 'Jane Smith', '456 Elm St', 'Los Angeles', 9876543210),
    (3, 'Alice Johnson', '789 Oak St', 'Chicago', 5551234567),
    (4, 'David Brown', '101 Pine St', 'Pimpri', 1112223333),
    (5, 'Daniel Clark', '321 Maple St', 'Pune', 9998887777),
    (6, 'Diana White', '555 Cedar St', 'Pimpri', 7776665555);

INSERT INTO Loan (loan_no, loan_amt)
VALUES
    (101, 15000.00),
    (102, 5000.00),
    (103, 2000000.00),
    (104, 800.00),
    (105, 1200000.00),
    (106, 10000.00);

INSERT INTO Customer_Loan (cust_no, loan_no)
VALUES
    (1, 101),
    (2, 102),
    (3, 103),
    (4, 104),
    (5, 105),
    (6, 106);

DELETE FROM Customer
WHERE cust_no IN (
    SELECT cl.cust_no
    FROM Customer_Loan cl
    JOIN Loan l ON cl.loan_no = l.loan_no
    WHERE l.loan_amt < 1000
);

        
SELECT c.*
FROM Customer c
JOIN Customer_Loan cl ON c.cust_no = cl.cust_no
JOIN Loan l ON cl.loan_no = l.loan_no
WHERE l.loan_amt > 1000000;

        
SELECT *
FROM Customer
WHERE cust_name LIKE 'D%';


SELECT c.cust_name
FROM Customer c
JOIN Customer_Loan cl ON c.cust_no = cl.cust_no
JOIN Loan l ON cl.loan_no = l.loan_no
WHERE c.city = 'Pimpri'
ORDER BY c.cust_name DESC;
----------------------------------------------------        
## SLIP 3
-- Creating the Hospital table
CREATE TABLE Hospital (
    hno INT PRIMARY KEY,
    hname VARCHAR(100),
    city VARCHAR(50),
    Est_year INT CHECK (Est_year > 1990),
    addr VARCHAR(255)
);

-- Creating the Doctor table
CREATE TABLE Doctor (
    dno INT PRIMARY KEY,
    dname VARCHAR(100),
    addr VARCHAR(255),
    Speciality VARCHAR(100),
    hno INT,
    FOREIGN KEY (hno) REFERENCES Hospital(hno)
);
-- Inserting values into the Hospital table
INSERT INTO Hospital (hno, hname, city, Est_year, addr)
VALUES 
    (1, 'Ruby Hospital', 'Pune', 1995, '123 Main Street'),
    (2, 'Sapphire Hospital', 'Pimpri', 2000, '456 Oak Avenue'),
    (3, 'Birla Hospital', 'Chinchwad', 1992, '789 Elm Street');

-- Inserting values into the Doctor table
INSERT INTO Doctor (dno, dname, addr, Speciality, hno)
VALUES 
    (101, 'Dr. Smith', '101 First Street', 'Cardiology', 1),
    (102, 'Dr. Johnson', '202 Second Street', 'Orthopedics', 1),
    (103, 'Dr. Williams', '303 Third Street', 'Pediatrics', 2),
    (104, 'Dr. Brown', '404 Fourth Street', 'Oncology', 3),
    (105, 'Dr. Wilson', '505 Fifth Street', 'Neurology', 3);
select * from hospital;
select * from doctor;
-- Deleting the addr column from the Hospital table
ALTER TABLE Hospital
DROP COLUMN addr;
select * from hospital;
SELECT d.dname AS Doctor_Name, h.hname AS Hospital_Name, d.Speciality AS Specialty
FROM Doctor d
JOIN Hospital h ON d.hno = h.hno
WHERE h.city = 'Pune';
SELECT hname
FROM Hospital
WHERE city = 'Pimpri';
SELECT d.dname AS Doctor_Name
FROM Doctor d
JOIN Hospital h ON d.hno = h.hno
WHERE h.hname = 'Birla Hospital' AND h.city = 'Chinchwad';
SELECT Speciality
FROM Doctor
WHERE hno = (
    SELECT hno
    FROM Hospital
    WHERE hname = 'Ruby Hospital'
);
----------------------------------------------------------
 ## SLIP 20
        
 -- Creating tables
CREATE TABLE Country (
    con_code INT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    capital VARCHAR(50) NOT NULL
);

CREATE TABLE Population (
    pop_code INT PRIMARY KEY,
    population INT,
    FOREIGN KEY (pop_code) REFERENCES Country(con_code)
);

-- Inserting sample data
INSERT INTO Country (con_code, name, capital)
VALUES 
    (1, 'India', 'Delhi'),
    (2, 'USA', 'Washington DC'),
    (3, 'China', 'Beijing');

INSERT INTO Population (pop_code, population)
VALUES 
    (1, 1380000000), -- India
    (2, 331000000),  -- USA
    (3, 1440000000); -- China

-- Queries
-- 1. Name and population of country whose capital is ‘Delhi’
SELECT c.name, p.population
FROM Country c
JOIN Population p ON c.con_code = p.pop_code
WHERE c.capital = 'Delhi';

-- 2. Count the number of countries whose population is > 60,00,000
SELECT COUNT(*)
FROM Population
WHERE population > 60000000;

-- 3. Find the country details with highest population
SELECT c.name, p.population
FROM Country c
JOIN Population p ON c.con_code = p.pop_code
WHERE p.population = (SELECT MAX(population) FROM Population);

-- 4. Display country wise population details
SELECT c.name, p.population
FROM Country c
JOIN Population p ON c.con_code = p.pop_code;
-------------------------------------------------------------- 
## SLIP 9
        
CREATE TABLE Owner (
    owner_name VARCHAR(255) PRIMARY KEY,
    addr VARCHAR(255),
    phno VARCHAR(15)
);

CREATE TABLE Property (
    pno INT PRIMARY KEY,
    desc VARCHAR(255),
    area DECIMAL(10,2),
    rate DECIMAL(10,2) CHECK (rate > 0),
    owner_name VARCHAR(255),
    FOREIGN KEY (owner_name) REFERENCES Owner(owner_name)
);
-- Inserting data into Owner table
INSERT INTO Owner (owner_name, addr, phno) VALUES 
('Mr. Smith', '123 Main St, Mumbai', '123-456-7890'),
('Mr. Johnson', '456 Oak St, Delhi', '456-789-0123'),
('Mr. Patil', '789 Pine St, Pune', '789-012-3456'),
('Mr. Joshi', '321 Maple St, Pune', '321-654-9870');

-- Inserting data into Property table
INSERT INTO Property (pno, desc, area, rate, owner_name) VALUES
(1, 'Apartment 1', 'Mumbai', 1200, 'Mr. Smith'),
(2, 'House 1', 'Delhi', 1500, 'Mr. Johnson'),
(3, 'Condo 1', 'Pune', 80000, 'Mr. Patil'),
(4, 'Villa 1', 'Pune', 100000, 'Mr. Joshi'),
(5, 'Apartment 2', 'Pune', 90000, 'Mr. Joshi'),
(6, 'House 2', 'Mumbai', 1100, 'Mr. Smith'),
(7, 'Condo 2', 'Delhi', 1400, 'Mr. Johnson'),
(8, 'Villa 2', 'Pune', 95000, 'Mr. Patil'),
(9, 'Apartment 3', 'Mumbai', 1050, 'Mr. Smith'),
(10, 'House 3', 'Delhi', 1600, 'Mr. Johnson');


-- 1. Display area of property whose rate is less than 100000
SELECT area FROM Property WHERE rate < 100000;

-- 2. Give the details of owner whose property is at “Pune”
SELECT Owner.* 
FROM Owner 
JOIN Property ON Owner.owner_name = Property.owner_name 
WHERE Property.area = 'Pune';

-- 3. Display area wise property details.
SELECT area, pno, desc, rate, owner_name 
FROM Property 
ORDER BY area;

-- 4. Display property owned by 'Mr.Patil' having minimum rate.
SELECT * 
FROM Property 
WHERE owner_name = 'Mr. Patil' 
AND rate = (SELECT MIN(rate) FROM Property WHERE owner_name = 'Mr. Patil');

-- 5. Delete all properties from “Pune” owned by “Mr. Joshi”.
DELETE FROM Property 
WHERE area = 'Pune' 
AND owner_name = 'Mr. Joshi';
---------------------------------------------------------    
## SLIP 16
-- Create Musician table
CREATE TABLE Musician (
    mno INT PRIMARY KEY,
    mname VARCHAR(100),
    addr VARCHAR(255),
    phno VARCHAR(15)
);

-- Create Album table
CREATE TABLE Album (
    title VARCHAR(100) PRIMARY KEY,
    copy_right_date DATE,
    format VARCHAR(50),
    mno INT,
    FOREIGN KEY (mno) REFERENCES Musician(mno)
);

-- Insert sample data into Musician table
INSERT INTO Musician (mno, mname, addr, phno)
VALUES
    (1, 'A R Rehman', 'Chennai', '9876543210'),
    (2, 'Hans Zimmer', 'Los Angeles', '1234567890'),
    (3, 'John Williams', 'New York', '5678901234'),
    (4, 'James Horner', 'Los Angeles', '6789012345');

-- Insert sample data into Album table
INSERT INTO Album (title, copy_right_date, format, mno)
VALUES
    ('Jodhaa Akbar', '2008-02-12', 'Audio', 1),
    ('Dil Se', '1998-08-21', 'Audio', 1),
    ('The Dark Knight', '2008-07-18', 'Audio', 2),
    ('Inception', '2010-07-16', 'Audio', 2),
    ('Jurassic Park', '1993-06-11', 'Audio', 3),
    ('Star Wars', '1977-05-25', 'Audio', 3),
    ('Titanic', '1997-11-18', 'Audio', 4),
    ('Avatar', '2009-12-18', 'Audio', 4),
    ('Lagaan', '2001-06-15', 'Audio', 1),
    ('Rang De Basanti', '2006-01-26', 'Audio', 1);

-- Execute the queries

-- 1. Display all albums composed by ‘A R Rehman’
SELECT *
FROM Album
WHERE mno = (SELECT mno FROM Musician WHERE mname = 'A R Rehman');

-- 2. Display musician details who have composed Audio album
SELECT m.*
FROM Musician m
JOIN Album a ON m.mno = a.mno
WHERE a.format = 'Audio';

-- 3. Find all musicians who have composed maximum albums
SELECT m.mname, COUNT(a.title) AS album_count
FROM Musician m
LEFT JOIN Album a ON m.mno = a.mno
GROUP BY m.mno
HAVING COUNT(a.title) = (
    SELECT COUNT(title)
    FROM Album
    GROUP BY mno
    ORDER BY COUNT(title) DESC
    LIMIT 1
);

-- 4. Display musician wise album details
SELECT m.mname, a.title, a.copy_right_date, a.format
FROM Musician m
JOIN Album a ON m.mno = a.mno
ORDER BY m.mname;
--------------------------------------------------------
    ## SLIP 26
CREATE TABLE ITEM (
    Item_No INT PRIMARY KEY,
    Item_Name VARCHAR(50),
    Unit_of_Measure VARCHAR(20)
);

CREATE TABLE SUPPLIER (
    S_No INT PRIMARY KEY,
    S_Name VARCHAR(50),
    S_Addr VARCHAR(100),
    S_City VARCHAR(50)
);

CREATE TABLE CUSTOMER (
    C_no INT PRIMARY KEY,
    C_name VARCHAR(50),
    C_Addr VARCHAR(100),
    C_City VARCHAR(50)
);

CREATE TABLE SUPPLY (
    Item_No INT,
    S_No INT,
    C_no INT,
    Cost DECIMAL(10, 2),
    FOREIGN KEY (Item_No) REFERENCES ITEM(Item_No),
    FOREIGN KEY (S_No) REFERENCES SUPPLIER(S_No),
    FOREIGN KEY (C_no) REFERENCES CUSTOMER(C_no),
    PRIMARY KEY (Item_No, S_No, C_no)
);
-- Sample data for ITEM
INSERT INTO ITEM (Item_No, Item_Name, Unit_of_Measure)
VALUES
    (1, 'Monitor', 'Piece'),
    (2, 'Keyboard', 'Piece'),
    (3, 'Mouse', 'Piece');

-- Sample data for SUPPLIER
INSERT INTO SUPPLIER (S_No, S_Name, S_Addr, S_City)
VALUES
    (101, 'DIGITAL COMPONENTS', '123 Main Street', 'New York'),
    (102, 'TechMart', '456 Broadway', 'Los Angeles'),
    (103, 'Electro World', '789 Oak Avenue', 'Chicago');

-- Sample data for CUSTOMER
INSERT INTO CUSTOMER (C_no, C_name, C_Addr, C_City)
VALUES
    (201, 'ABC Ltd', '1001 Elm Street', 'New York'),
    (202, 'XYZ Inc', '2002 Maple Avenue', 'Los Angeles'),
    (203, 'LMN Corp', '3003 Oak Street', 'Chicago');

-- Sample data for SUPPLY
INSERT INTO SUPPLY (Item_No, S_No, C_no, Cost)
VALUES
    (1, 101, 201, 150.00),  -- Monitor supplied by DIGITAL COMPONENTS to ABC Ltd
    (2, 102, 202, 30.00),   -- Keyboard supplied by TechMart to XYZ Inc
    (1, 102, 201, 160.00),  -- Monitor supplied by TechMart to ABC Ltd
    (2, 101, 203, 35.00),   -- Keyboard supplied by DIGITAL COMPONENTS to LMN Corp
    (3, 103, 201, 15.00);   -- Mouse supplied by Electro World to ABC Ltd


SELECT AVG(Cost) AS Average_Cost
FROM SUPPLY
WHERE S_No = (SELECT S_No FROM SUPPLIER WHERE S_Name = 'DIGITAL COMPONENTS')
AND Item_No = (SELECT Item_No FROM ITEM WHERE Item_Name = 'Monitor');


SELECT S.S_Name AS Supplier_Name, C.C_name AS Customer_Name
FROM SUPPLY AS S1
JOIN SUPPLIER AS S ON S1.S_No = S.S_No
JOIN CUSTOMER AS C ON S1.C_no = C.C_no
WHERE S1.Item_No = (SELECT Item_No FROM ITEM WHERE Item_Name = 'Keyboard')
AND S1.Cost > (SELECT MAX(Cost) FROM SUPPLY WHERE Item_No = S1.Item_No);


SELECT I.Item_Name
FROM SUPPLY AS S
JOIN ITEM AS I ON S.Item_No = I.Item_No
JOIN CUSTOMER AS C ON S.C_no = C.C_no
WHERE C.C_name = 'ABC Ltd';


SELECT DISTINCT S.S_Name AS Supplier_Name
FROM SUPPLIER AS S
JOIN SUPPLY AS S1 ON S.S_No = S1.S_No
JOIN CUSTOMER AS C ON S1.C_no = C.C_no
WHERE S.S_City = C.C_City;  
------------------------------------------------------------    
 ## SLIP 2
 -- Create Client table
CREATE TABLE Client (
    clientNo VARCHAR(10) PRIMARY KEY,
    ClientName VARCHAR(100) NOT NULL,
    addr VARCHAR(255)
);

-- Create Sales_order table
CREATE TABLE Sales_order (
    ordNo INT PRIMARY KEY,
    ordDate DATE NOT NULL,
    clientNo VARCHAR(10),
    FOREIGN KEY (clientNo) REFERENCES Client(clientNo)
);

-- Add constraint for Sales_order table
ALTER TABLE Sales_order ADD CONSTRAINT check_ordDate_not_null CHECK (ordDate IS NOT NULL);

ALTER TABLE Sales_order 
ADD amount INT;

-- Sample data for Client table
INSERT INTO Client (clientNo, ClientName, addr) VALUES 
('CN001', 'John Doe', '123 Main St'),
('CN002', 'Jane Smith', '456 Oak St'),
('CN003', 'Patil', '789 Elm St');

-- Sample data for Sales_order table
INSERT INTO Sales_order (ordNo, ordDate, clientNo, amount) VALUES 
(1, '2019-08-09', 'CN001', 100),
(2, '2019-08-09', 'CN002', 150),
(3, '2019-08-10', 'CN001', 200),
(4, '2019-08-10', 'CN003', 250);

DELETE FROM Client 
WHERE ClientName LIKE 'A%';

DELETE FROM Sales_order 
WHERE clientNo IN (SELECT clientNo FROM Client WHERE ClientName = 'Patil') 
AND ordDate = '2019-08-09';

UPDATE Sales_order 
SET ordDate = '2019-03-18' 
WHERE clientNo = 'CN001' AND ordDate = '2019-03-18';

SELECT ordDate, COUNT(*) AS orderCount 
FROM Sales_order 
GROUP BY ordDate;
        
</code>
</pre>
</body>
</html>
